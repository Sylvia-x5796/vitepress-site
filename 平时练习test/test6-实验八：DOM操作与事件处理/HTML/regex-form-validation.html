<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>正则表达式表单验证</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input, select, textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        input.valid {
            border-color: green;
        }
        input.invalid {
            border-color: red;
        }
        button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background-color: #45a049;
        }
        .error-message {
            color: red;
            font-size: 0.8em;
            margin-top: 5px;
        }
        .success-message {
            color: green;
            font-size: 0.8em;
            margin-top: 5px;
        }
        .regex-info {
            background-color: #f5f5f5;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 10px;
            margin-bottom: 10px;
            font-size: 0.8em;
        }
        .regex-pattern {
            font-family: monospace;
            background-color: #e8e8e8;
            padding: 2px 4px;
            border-radius: 3px;
        }
        .validation-tabs {
            display: flex;
            border-bottom: 1px solid #ddd;
            margin-bottom: 20px;
        }
        .tab {
            padding: 10px 15px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
        }
        .tab.active {
            border-bottom: 2px solid #4CAF50;
            font-weight: bold;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <h1>正则表达式表单验证</h1>
    
    <div class="validation-tabs">
        <div class="tab active" data-tab="basic">基本验证</div>
        <div class="tab" data-tab="advanced">高级验证</div>
        <div class="tab" data-tab="custom">自定义验证</div>
    </div>
    
    <!-- 基本验证标签页 -->
    <div id="basic" class="tab-content active">
        <form id="basic-regex-form">
            <div class="form-group">
                <label for="chinese-name">中文姓名：</label>
                <div class="regex-info">
                    正则表达式：<span class="regex-pattern">/^[\u4e00-\u9fa5]{2,4}$/</span><br>
                    说明：2-4个中文字符
                </div>
                <input type="text" id="chinese-name" name="chinese-name" placeholder="请输入中文姓名">
                <div class="error-message" id="chinese-name-error"></div>
            </div>
            
            <div class="form-group">
                <label for="english-name">英文姓名：</label>
                <div class="regex-info">
                    正则表达式：<span class="regex-pattern">/^[a-zA-Z\s]{2,50}$/</span><br>
                    说明：2-50个英文字母和空格
                </div>
                <input type="text" id="english-name" name="english-name" placeholder="请输入英文姓名">
                <div class="error-message" id="english-name-error"></div>
            </div>
            
            <div class="form-group">
                <label for="phone-number">手机号码：</label>
                <div class="regex-info">
                    正则表达式：<span class="regex-pattern">/^1[3-9]\d{9}$/</span><br>
                    说明：以1开头，第二位为3-9，后面9位数字
                </div>
                <input type="text" id="phone-number" name="phone-number" placeholder="请输入手机号码">
                <div class="error-message" id="phone-number-error"></div>
            </div>
            
            <div class="form-group">
                <label for="landline">固定电话：</label>
                <div class="regex-info">
                    正则表达式：<span class="regex-pattern">/^0\d{2,3}-?\d{7,8}$/</span><br>
                    说明：以0开头，区号2-3位，连字符可选，号码7-8位
                </div>
                <input type="text" id="landline" name="landline" placeholder="请输入固定电话">
                <div class="error-message" id="landline-error"></div>
            </div>
            
            <button type="submit">验证基本表单</button>
        </form>
    </div>
    
    <!-- 高级验证标签页 -->
    <div id="advanced" class="tab-content">
        <form id="advanced-regex-form">
            <div class="form-group">
                <label for="ip-address">IP地址：</label>
                <div class="regex-info">
                    正则表达式：<span class="regex-pattern">/^((25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(25[0-5]|2[0-4]\d|[01]?\d\d?)$/</span><br>
                    说明：IPv4地址格式，每段0-255
                </div>
                <input type="text" id="ip-address" name="ip-address" placeholder="请输入IP地址">
                <div class="error-message" id="ip-address-error"></div>
            </div>
            
            <div class="form-group">
                <label for="mac-address">MAC地址：</label>
                <div class="regex-info">
                    正则表达式：<span class="regex-pattern">/^([0-9A-Fa-f]{2}[:-]){5}([0-9A-Fa-f]{2})$/</span><br>
                    说明：6组2位十六进制数，用冒号或连字符分隔
                </div>
                <input type="text" id="mac-address" name="mac-address" placeholder="请输入MAC地址">
                <div class="error-message" id="mac-address-error"></div>
            </div>
            
            <div class="form-group">
                <label for="url">URL地址：</label>
                <div class="regex-info">
                    正则表达式：<span class="regex-pattern">/^(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?$/</span><br>
                    说明：HTTP或HTTPS协议开头，域名和路径
                </div>
                <input type="text" id="url" name="url" placeholder="请输入URL地址">
                <div class="error-message" id="url-error"></div>
            </div>
            
            <div class="form-group">
                <label for="hex-color">十六进制颜色值：</label>
                <div class="regex-info">
                    正则表达式：<span class="regex-pattern">/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/</span><br>
                    说明：以#开头，后面3位或6位十六进制数
                </div>
                <input type="text" id="hex-color" name="hex-color" placeholder="请输入十六进制颜色值">
                <div class="error-message" id="hex-color-error"></div>
            </div>
            
            <button type="submit">验证高级表单</button>
        </form>
    </div>
    
    <!-- 自定义验证标签页 -->
    <div id="custom" class="tab-content">
        <form id="custom-regex-form">
            <div class="form-group">
                <label for="custom-field">自定义字段：</label>
                <div class="regex-info">
                    自定义正则表达式：<input type="text" id="custom-regex" placeholder="请输入正则表达式，如：/^\d{6}$/"><br>
                    说明：输入自定义正则表达式来验证下面的字段
                </div>
                <input type="text" id="custom-field" name="custom-field" placeholder="请输入要验证的内容">
                <div class="error-message" id="custom-field-error"></div>
            </div>
            
            <div class="form-group">
                <label for="test-input">测试正则表达式：</label>
                <div class="regex-info">
                    测试正则表达式：<span class="regex-pattern" id="test-regex-display">/^\d{6}$/</span><br>
                    说明：输入测试内容，验证是否匹配正则表达式
                </div>
                <input type="text" id="test-input" placeholder="请输入测试内容">
                <div id="test-result"></div>
            </div>
            
            <button type="submit">验证自定义表单</button>
        </form>
    </div>
    
    <script>
        // 标签页切换功能
        const tabs = document.querySelectorAll('.tab');
        const tabContents = document.querySelectorAll('.tab-content');
        
        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                // 移除所有标签页的active类
                tabs.forEach(t => t.classList.remove('active'));
                tabContents.forEach(tc => tc.classList.remove('active'));
                
                // 添加当前标签页的active类
                tab.classList.add('active');
                const tabId = tab.getAttribute('data-tab');
                document.getElementById(tabId).classList.add('active');
            });
        });
        
        // 基本验证表单
        const basicForm = document.getElementById('basic-regex-form');
        const basicValidationRules = {
            'chinese-name': {
                pattern: /^[\u4e00-\u9fa5]{2,4}$/,
                message: '请输入2-4个中文字符'
            },
            'english-name': {
                pattern: /^[a-zA-Z\s]{2,50}$/,
                message: '请输入2-50个英文字母和空格'
            },
            'phone-number': {
                pattern: /^1[3-9]\d{9}$/,
                message: '请输入有效的11位手机号码'
            },
            'landline': {
                pattern: /^0\d{2,3}-?\d{7,8}$/,
                message: '请输入有效的固定电话号码'
            }
        };
        
        // 高级验证表单
        const advancedForm = document.getElementById('advanced-regex-form');
        const advancedValidationRules = {
            'ip-address': {
                pattern: /^((25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(25[0-5]|2[0-4]\d|[01]?\d\d?)$/,
                message: '请输入有效的IP地址'
            },
            'mac-address': {
                pattern: /^([0-9A-Fa-f]{2}[:-]){5}([0-9A-Fa-f]{2})$/,
                message: '请输入有效的MAC地址'
            },
            'url': {
                pattern: /^(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?$/,
                message: '请输入有效的URL地址'
            },
            'hex-color': {
                pattern: /^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,
                message: '请输入有效的十六进制颜色值'
            }
        };
        
        // 自定义验证表单
        const customForm = document.getElementById('custom-regex-form');
        let customRegex = /^\d{6}$/; // 默认正则表达式
        
        // 自定义正则表达式输入框
        const customRegexInput = document.getElementById('custom-regex');
        customRegexInput.addEventListener('input', function() {
            try {
                // 尝试解析正则表达式
                const regexString = this.value.trim();
                if (regexString) {
                    // 移除斜杠并获取标志
                    const match = regexString.match(/^\/(.*)\/([gimuy]*)$/);
                    if (match) {
                        customRegex = new RegExp(match[1], match[2]);
                    } else {
                        customRegex = new RegExp(regexString);
                    }
                    
                    // 更新显示
                    document.getElementById('test-regex-display').textContent = regexString;
                }
            } catch (e) {
                console.error('正则表达式解析错误:', e);
            }
        });
        
        // 测试正则表达式
        const testInput = document.getElementById('test-input');
        const testResult = document.getElementById('test-result');
        
        testInput.addEventListener('input', function() {
            const value = this.value.trim();
            if (value) {
                const isMatch = customRegex.test(value);
                testResult.textContent = isMatch ? '✓ 匹配' : '✗ 不匹配';
                testResult.style.color = isMatch ? 'green' : 'red';
            } else {
                testResult.textContent = '';
            }
        });
        
        // 表单提交事件处理
        basicForm.addEventListener('submit', function(event) {
            event.preventDefault();
            validateFormWithRegex(basicForm, basicValidationRules);
        });
        
        advancedForm.addEventListener('submit', function(event) {
            event.preventDefault();
            validateFormWithRegex(advancedForm, advancedValidationRules);
        });
        
        customForm.addEventListener('submit', function(event) {
            event.preventDefault();
            const customValidationRules = {
                'custom-field': {
                    pattern: customRegex,
                    message: '输入内容不符合自定义正则表达式'
                }
            };
            validateFormWithRegex(customForm, customValidationRules);
        });
        
        // 使用正则表达式验证表单
        function validateFormWithRegex(form, validationRules) {
            let isValid = true;
            
            // 遍历所有验证规则
            for (const fieldName in validationRules) {
                const field = document.getElementById(fieldName);
                const rule = validationRules[fieldName];
                const value = field.value.trim();
                
                // 清除之前的验证状态
                clearFieldValidation(fieldName);
                
                // 检查是否为空
                if (!value) {
                    setFieldValidation(fieldName, false, '此字段不能为空');
                    isValid = false;
                    continue;
                }
                
                // 检查正则表达式
                if (!rule.pattern.test(value)) {
                    setFieldValidation(fieldName, false, rule.message);
                    isValid = false;
                } else {
                    setFieldValidation(fieldName, true, '验证通过');
                }
            }
            
            // 显示验证结果
            if (isValid) {
                alert('表单验证通过！');
            } else {
                alert('请修正表单中的错误！');
            }
            
            return isValid;
        }
        
        // 设置字段验证状态
        function setFieldValidation(fieldName, isValid, message) {
            const field = document.getElementById(fieldName);
            const errorElement = document.getElementById(fieldName + '-error');
            
            if (isValid) {
                field.classList.remove('invalid');
                field.classList.add('valid');
                
                if (errorElement) {
                    errorElement.textContent = message;
                    errorElement.classList.remove('error-message');
                    errorElement.classList.add('success-message');
                }
            } else {
                field.classList.remove('valid');
                field.classList.add('invalid');
                
                if (errorElement) {
                    errorElement.textContent = message;
                    errorElement.classList.remove('success-message');
                    errorElement.classList.add('error-message');
                }
            }
        }
        
        // 清除字段验证状态
        function clearFieldValidation(fieldName) {
            const field = document.getElementById(fieldName);
            const errorElement = document.getElementById(fieldName + '-error');
            
            field.classList.remove('valid', 'invalid');
            
            if (errorElement) {
                errorElement.textContent = '';
                errorElement.classList.remove('success-message', 'error-message');
            }
        }
        
        // 为所有输入框添加实时验证
        const allInputs = document.querySelectorAll('input[type="text"]');
        allInputs.forEach(input => {
            input.addEventListener('blur', function() {
                const fieldName = this.id;
                const value = this.value.trim();
                
                if (!value) {
                    setFieldValidation(fieldName, false, '此字段不能为空');
                    return;
                }
                
                // 根据表单选择相应的验证规则
                let validationRules;
                if (basicForm.contains(this)) {
                    validationRules = basicValidationRules;
                } else if (advancedForm.contains(this)) {
                    validationRules = advancedValidationRules;
                } else if (customForm.contains(this) && fieldName === 'custom-field') {
                    validationRules = {
                        'custom-field': {
                            pattern: customRegex,
                            message: '输入内容不符合自定义正则表达式'
                        }
                    };
                }
                
                if (validationRules && validationRules[fieldName]) {
                    const rule = validationRules[fieldName];
                    if (rule.pattern.test(value)) {
                        setFieldValidation(fieldName, true, '验证通过');
                    } else {
                        setFieldValidation(fieldName, false, rule.message);
                    }
                }
            });
        });
    </script>
</body>
</html>