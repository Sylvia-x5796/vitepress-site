# 实践项目3

## 基于vitepress快速建站项目

### 项目概述

在已有的Web开发基础上，使用VitePress快速搭建一个个人网站或文档网站，并实现网站构建部署，并持续提升网站开发效率和用户体验。（Tips：巩固Markdown语法，熟悉VitePress的配置和主题定制，掌握静态网站生成的基本概念，实现网站构建部署）

### 项目目标

1. 掌握VitePress的基本概念和安装方法
2. 能够使用VitePress创建和配置网站
3. 理解Markdown扩展语法在VitePress中的应用
4. 掌握VitePress主题定制的基本方法
5. 能够使用云服务器部署Vitepress静态网站
6. 了解静态网站生成器的工作原理和优势
7. 能够根据需求扩展VitePress功能

### 实践项目步骤

**推荐：参考Vitepress官方网站的[快速开始](https://vitejs.cn/vitepress/guide/getting-started)文档。**

**步骤一：安装VitePress**

首先，我们需要创建一个项目目录并安装VitePress。

```bash
# 创建项目目录
mkdir vitepress-site
cd vitepress-site

# 初始化npm项目
npm init -y

# 安装VitePress
npm install vitepress@latest
```

**步骤二：创建基本目录结构**

创建VitePress所需的基本目录结构和文件。

```bash
# 创建docs目录
mkdir docs

# 创建基本的Markdown文件
touch docs/index.md
```

**步骤三：配置package.json脚本**

在package.json中添加VitePress的脚本命令。

```json
{
  "name": "vitepress-site",
  "version": "1.0.0",
  "scripts": {
    "docs:dev": "vitepress dev docs",
    "docs:build": "vitepress build docs",
    "docs:preview": "vitepress preview docs"
  },
  "devDependencies": {
    "vitepress": "^1.0.0"
  }
}
```

**步骤四：创建配置文件**

在docs目录下创建.vitepress目录和配置文件。

```bash
mkdir docs/.vitepress
touch docs/.vitepress/config.mts
```

编辑配置文件，添加基本配置：

```typescript
// docs/.vitepress/config.mts
import { defineConfig } from 'vitepress'

export default defineConfig({
  title: '我的个人网站',
  description: '使用VitePress搭建的个人网站',
  themeConfig: {
    nav: [
      { text: '首页', link: '/' },
      { text: '关于我', link: '/about' },
      { text: '博客', link: '/blog' },
      { text: '文档', link: '/docs' }
    ],
    sidebar: {
      '/docs/': [
        {
          text: '指南',
          items: [
            { text: '快速开始', link: '/docs/guide/getting-started' },
            { text: '配置', link: '/docs/guide/configuration' }
          ]
        },
        {
          text: '参考',
          items: [
            { text: 'API', link: '/docs/reference/api' },
            { text: '主题配置', link: '/docs/reference/theme-config' }
          ]
        }
      ]
    }
  }
})
```

**步骤五：创建首页内容**

编辑docs/index.md文件，添加首页内容：

```markdown
---
title: 首页
description: 我的个人网站首页
---

# 欢迎来到我的个人网站

这是一个使用VitePress搭建的个人网站。

## 关于我

我是一名Web开发爱好者，热爱技术分享和开源贡献。

## 我的技能

- HTML5 & CSS3
- JavaScript (ES6+)
- React & Vue
- Node.js
- Vite & VitePress

## 联系方式

- 邮箱：example@example.com
- GitHub：https://github.com/example
- 知乎：https://zhihu.com/people/example
```

**步骤六：创建其他页面**

创建about.md、blog目录和docs目录，并添加相应的内容：

```bash
# 创建about.md
touch docs/about.md

# 创建blog目录和示例文章
mkdir docs/blog
touch docs/blog/first-post.md

# 创建docs目录结构
mkdir -p docs/docs/guide docs/docs/reference
touch docs/docs/guide/getting-started.md docs/docs/guide/configuration.md
touch docs/docs/reference/api.md docs/docs/reference/theme-config.md
```

编辑about.md文件：

```markdown
---
title: 关于我
description: 关于我的个人介绍
---

# 关于我

## 基本信息

- 姓名：张三
- 职业：Web开发工程师
- 邮箱：example@example.com

## 教育背景

- 2020年9月 - 2024年6月 西南大学 计算机科学与技术 本科

## 工作经历

- 2024年7月至今 某科技公司 前端开发工程师

## 兴趣爱好

- 编程
- 阅读
- 旅行
- 摄影
```

**步骤七：启动开发服务器**

运行开发服务器，预览网站效果：

```bash
npm run docs:dev
```

打开浏览器访问 http://localhost:5173 查看效果。

**步骤八：自定义主题样式**

创建主题配置文件，自定义网站样式：

```bash
mkdir docs/.vitepress/theme
touch docs/.vitepress/theme/index.ts
```

编辑主题配置文件：

```typescript
// docs/.vitepress/theme/index.ts
import DefaultTheme from 'vitepress/theme'
import './custom.css'

export default {
  ...DefaultTheme,
  enhanceApp({ app, router, siteData }) {
    // 可以在这里注册全局组件或插件
  }
}
```

创建自定义CSS文件：

```css
/* docs/.vitepress/theme/custom.css */
:root {
  --vp-c-brand: #3498db;
  --vp-c-brand-light: #5dade2;
  --vp-c-brand-dark: #2980b9;
}

/* 自定义首页样式 */
.VPHome {
  background-color: #f8f9fa;
}

/* 自定义标题样式 */
h1 {
  font-weight: 700;
  margin-bottom: 1rem;
}
```

**步骤九：添加导航栏和侧边栏**

在config.mts中完善导航栏和侧边栏配置：

```typescript
// docs/.vitepress/config.mts
import { defineConfig } from 'vitepress'

export default defineConfig({
  title: '我的个人网站',
  description: '使用VitePress搭建的个人网站',
  themeConfig: {
    nav: [
      { text: '首页', link: '/' },
      { text: '关于我', link: '/about' },
      { text: '博客', link: '/blog' },
      { text: '文档', link: '/docs' },
      { text: 'GitHub', link: 'https://github.com/example', target: '_blank' }
    ],
    sidebar: {
      '/blog/': [
        {
          text: '博客文章',
          items: [
            { text: '我的第一篇博客', link: '/blog/first-post' }
          ]
        }
      ],
      '/docs/': [
        {
          text: '指南',
          items: [
            { text: '快速开始', link: '/docs/guide/getting-started' },
            { text: '配置', link: '/docs/guide/configuration' }
          ]
        },
        {
          text: '参考',
          items: [
            { text: 'API', link: '/docs/reference/api' },
            { text: '主题配置', link: '/docs/reference/theme-config' }
          ]
        }
      ]
    },
    socialLinks: [
      { icon: 'github', link: 'https://github.com/example' },
      { icon: 'twitter', link: 'https://twitter.com/example' },
      { icon: 'linkedin', link: 'https://linkedin.com/in/example' }
    ]
  }
})
```

**步骤十：构建和部署网站**

构建静态网站文件：

```bash
npm run docs:build
```

构建完成后，静态文件将生成在docs/.vitepress/dist目录中。你可以使用以下命令预览构建后的网站：

```bash
npm run docs:preview
```

部署网站到GitHub Pages或其他静态网站托管服务：

```bash
# 安装gh-pages
npm install -D gh-pages

# 在package.json中添加部署脚本
# "deploy": "gh-pages -d docs/.vitepress/dist"

# 部署网站
npm run deploy
```

### 使用阿里云部署网站

除了GitHub Pages，你也可以使用阿里云的各种云服务来部署你的VitePress网站。以下是几种常见的阿里云部署方案：


#### 方案一：使用阿里云ECS（云服务器）

如果你需要更灵活的控制，可以使用ECS云服务器部署网站。

**步骤1：购买并配置ECS实例**

1. 登录阿里云控制台
2. 进入ECS服务
3. 点击"创建实例"
4. 选择合适的实例规格、操作系统（推荐Alibaba Cloud Linux、Ubuntu等Linux操作系统）
5. 配置网络和安全组（确保开放80端口）

**步骤2：连接到ECS实例**

```bash
# 使用SSH连接到你的ECS实例
ssh root@your-ecs-ip-address
```

**步骤3：安装Nginx**

```bash
# Ubuntu/Debian
apt update
apt install nginx -y

# CentOS/RHEL
yum update
yum install nginx -y
```

**步骤4：配置Nginx**

创建Nginx配置文件：

```bash
nano /etc/nginx/sites-available/vitepress
```

添加以下配置：

```nginx
server {
    listen 80;
    server_name your-domain.com;  # 替换为你的域名或IP地址

    root /var/www/vitepress;
    index index.html;

    location / {
        try_files $uri $uri/ /index.html;
    }

    # 缓存静态资源
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
}
```

启用配置：

```bash
# 创建软链接
ln -s /etc/nginx/sites-available/vitepress /etc/nginx/sites-enabled/

# 测试配置
nginx -t

# 重启Nginx
systemctl restart nginx
```

**步骤5：上传网站文件**

```bash
# 创建网站目录
mkdir -p /var/www/vitepress

# 从本地上传文件到ECS（在本地执行）
scp -r docs/.vitepress/dist/* root@your-ecs-ip-address:/var/www/vitepress/

# 或者使用Git在ECS上克隆代码并构建
git clone https://github.com/your-username/your-repo.git /tmp/your-repo
cd /tmp/your-repo
npm install
npm run docs:build
cp -r docs/.vitepress/dist/* /var/www/vitepress/
```

#### 方案二：使用阿里云轻量应用服务器

阿里云轻量应用服务器是一种简单、经济、高效的云服务器，非常适合个人开发者和小型项目使用。相比ECS，轻量应用服务器提供了更简化的管理界面和预装的应用环境。

**步骤1：创建轻量应用服务器实例**

1. 登录阿里云控制台
2. 进入轻量应用服务器服务
3. 点击"创建实例"
4. 配置实例参数：
   - 服务器套餐：根据你的需求选择合适的配置（如2核2G、2核4G等）
   - 镜像：选择"应用镜像"中的"WordPress"或"Node.js"镜像，或选择"系统镜像"中的Ubuntu/CentOS
   - 存储：默认提供系统盘，可根据需要添加数据盘
   - 网络：默认使用VPC网络，确保开放80和443端口
   - 实例名称：设置一个易于识别的名称

**步骤2：连接到轻量应用服务器**

轻量应用服务器提供了多种连接方式：

**方式一：通过阿里云控制台远程连接**
1. 在实例列表中找到你的服务器
2. 点击"远程连接"
3. 选择"Workbench远程连接"或"一键登录"

**方式二：使用SSH连接**
```bash
# 使用SSH连接到你的轻量应用服务器
ssh root@your-server-ip-address
```

**步骤3：安装Node.js和Nginx（如果选择系统镜像）**

如果你选择的是系统镜像（如Ubuntu/CentOS），需要手动安装Node.js和Nginx：

```bash
# Ubuntu/Debian系统
apt update
apt install -y nodejs npm nginx

# CentOS/RHEL系统
yum update
yum install -y nodejs npm nginx

# 安装nvm（Node版本管理器）
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash
source ~/.bashrc

# 安装最新稳定版Node.js
nvm install --lts
```

**步骤4：配置Nginx**

创建Nginx配置文件：

```bash
nano /etc/nginx/sites-available/vitepress
```

添加以下配置：

```nginx
server {
    listen 80;
    server_name your-domain.com;  # 替换为你的域名或IP地址

    root /var/www/vitepress;
    index index.html;

    location / {
        try_files $uri $uri/ /index.html;
    }

    # 缓存静态资源
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }

    # Gzip压缩
    gzip on;
    gzip_vary on;
    gzip_min_length 1024;
    gzip_proxied expired no-cache no-store private must-revalidate auth;
    gzip_types text/plain text/css text/xml text/javascript application/x-javascript application/xml+rss application/javascript;
}
```

启用配置：

```bash
# Ubuntu/Debian系统
ln -s /etc/nginx/sites-available/vitepress /etc/nginx/sites-enabled/
rm /etc/nginx/sites-enabled/default

# CentOS/RHEL系统
# 编辑/etc/nginx/nginx.conf，在http块中添加include /etc/nginx/conf.d/*.conf;
mkdir -p /etc/nginx/conf.d
ln -s /etc/nginx/sites-available/vitepress /etc/nginx/conf.d/vitepress.conf

# 测试配置
nginx -t

# 重启Nginx
systemctl restart nginx
```

**步骤5：上传和构建网站**

有两种方式部署网站：

**方式一：在本地构建后上传**

```bash
# 在本地执行构建
npm run docs:build

# 上传到服务器（在本地执行）
scp -r docs/.vitepress/dist/* root@your-server-ip-address:/var/www/vitepress/
```

**方式二：在服务器上构建**

```bash
# 连接到服务器后执行
mkdir -p /var/www/vitepress
cd /var/www

# 克隆代码仓库
git clone https://github.com/your-username/your-repo.git

# 安装依赖并构建
cd your-repo
npm install
npm run docs:build

# 复制构建结果到网站目录
cp -r docs/.vitepress/dist/* /var/www/vitepress/

# 设置正确的文件权限
chown -R www-data:www-data /var/www/vitepress
chmod -R 755 /var/www/vitepress
```

**步骤6：配置域名和SSL证书（可选）**

如果你有自己的域名，可以将其解析到轻量应用服务器的IP地址，并配置SSL证书：

```bash
# 安装Certbot（Let's Encrypt客户端）
# Ubuntu/Debian
apt install certbot python3-certbot-nginx

# CentOS/RHEL
yum install certbot python3-certbot-nginx

# 获取并安装SSL证书
certbot --nginx -d your-domain.com

# 设置自动续期
crontab -e
# 添加以下行
0 12 * * * /usr/bin/certbot renew --quiet
```

**步骤7：设置自动部署脚本**

为了方便后续更新，可以创建一个自动部署脚本：

```bash
# 创建部署脚本
nano /var/www/deploy.sh
```

添加以下内容：

```bash
#!/bin/bash

# 设置变量
REPO_URL="https://github.com/your-username/your-repo.git"
SITE_DIR="/var/www/vitepress"
TEMP_DIR="/tmp/vitepress-temp"

# 创建临时目录
mkdir -p $TEMP_DIR

# 克隆最新代码
git clone $REPO_URL $TEMP_DIR

# 进入项目目录
cd $TEMP_DIR

# 安装依赖
npm install

# 构建网站
npm run docs:build

# 备份当前网站
if [ -d "$SITE_DIR" ]; then
    cp -r $SITE_DIR $SITE_DIR.backup.$(date +%Y%m%d%H%M%S)
fi

# 部署新版本
rm -rf $SITE_DIR
mkdir -p $SITE_DIR
cp -r docs/.vitepress/dist/* $SITE_DIR/

# 设置正确的文件权限
chown -R www-data:www-data $SITE_DIR
chmod -R 755 $SITE_DIR

# 清理临时文件
rm -rf $TEMP_DIR

echo "部署完成！"
```

设置脚本执行权限：

```bash
chmod +x /var/www/deploy.sh
```

现在，你可以通过运行`/var/www/deploy.sh`来更新你的网站。

**轻量应用服务器的优势**

相比ECS，轻量应用服务器有以下优势：

1. **简化的管理界面**：提供图形化管理界面，操作更直观
2. **预装应用环境**：可选择预装WordPress、Node.js等应用环境，省去配置时间
3. **固定价格**：套餐价格固定，包含流量，成本更可控
4. **一键备份**：支持一键创建和恢复快照，数据更安全
5. **内置监控**：提供基础监控功能，无需额外配置

轻量应用服务器非常适合个人博客、小型企业官网、文档站点等场景，是VitePress网站部署的理想选择。

### 项目扩展建议

完成基本要求后，你可以尝试以下扩展内容：

1. 添加自定义组件和布局
2. 集成评论系统（如Giscus）
3. 添加搜索功能
4. 配置多语言支持
5. 自定义主题颜色和样式
6. 添加站点统计（如Google Analytics）
7. 集成RSS订阅功能
8. 优化网站性能和SEO

### 项目检查清单

**实验报告提交位置为<实践项目3-基于vitepress快速建站>，在该目录下新建子目录，并将子目录命名为"学号-姓名-实践项目3"，在该子目录下新建“实践项目3.md”和“images”文件夹,并按照模板撰写实验报告，在“images”目录中上传截图。**

请按照实验报告模版撰写基于vitepress快速建站实践项目实验报告，在提交实验报告前，请检查以下内容：

1. VitePress是否正确安装和配置？
2. 网站基本结构是否完整？
3. 是否使用了Markdown扩展语法？
4. 导航栏和侧边栏是否配置正确？
5. 主题样式是否自定义？
6. 网站是否能够成功构建？
7. 代码结构是否清晰，是否有适当的注释？
8. 网站在不同浏览器中的兼容性如何？
9. 文件目录的命名是否正确，实验报告的扩展名是否为.md？
10. 是否按照要求提交了实验报告和截图？
